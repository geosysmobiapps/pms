{% extends 'staff/base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid">
        <!-- Page Header -->
    <div class="my-2 flex-column text-center">
        <h1 class="page-title fw-bold fs-18 mb-0 txt-dark"> 
            <span><i class="ti ti-building"></i> BuildMaster Construction Ltd.</span> 
        </h1>
    </div>
    <!-- Welcome Section -->
    <div class="dashboard-welcome">
        <div class="welcome-content">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h2 class="text-dark mb-2">Welcome, Michael!</h2>
                    <p class="text-muted mb-0">Here's what's happening with your projects today.</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <p class="mb-0"><strong>Thursday, November 23, 2023</strong></p>
                    <p class="text-muted">8:42 AM</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="row g-2 mb-1">
        <div class="col-3 col-md-3">
            <div class="card custom-card text-center h-90">
                <div class="card-body p-3">
                    <div class="avatar mx-auto mb-2 bg-primary-transparent rounded-circle" 
                         style="width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-building-fill fs-20 text-primary"></i>
                    </div>
                    <h5 class="mb-0">4</h5>
                    <p class="text-muted mb-0 small">Active Projects</p>
                </div>
            </div>
        </div>

        <div class="col-3 col-md-3">
            <div class="card custom-card text-center h-90">
                <div class="card-body p-3">
                    <div class="avatar mx-auto mb-2 bg-warning-transparent rounded-circle" 
                         style="width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-calendar-event-fill fs-20 text-warning"></i>
                    </div>
                    <h5 class="mb-0">3</h5>
                    <p class="text-muted mb-0 small">Upcoming Deadlines</p>
                </div>
            </div>
        </div>

        <div class="col-3 col-md-3">
            <div class="card custom-card text-center h-90">
                <div class="card-body p-3">
                    <div class="avatar mx-auto mb-2 bg-success-transparent rounded-circle" 
                         style="width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-checkbox-circle-fill fs-20 text-success"></i>
                    </div>
                    <h5 class="mb-0">18/24</h5>
                    <p class="text-muted mb-0 small">Tasks Completed</p>
                </div>
            </div>
        </div>

        <div class="col-3 col-md-3">
            <div class="card custom-card text-center h-90">
                <div class="card-body p-3">
                    <div class="avatar mx-auto mb-2 bg-info-transparent rounded-circle" 
                         style="width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-time-fill fs-20 text-info"></i>
                    </div>
                    <h5 class="mb-0">42.5</h5>
                    <p class="text-muted mb-0 small">Hours This Week</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row">
        <!-- Project Progress Chart -->
        <div class="col-xxl-8">
            <div class="card custom-card">
                <div class="card-header justify-content-between">
                    <div class="card-title">Project Progress Overview</div>
                    <div class="dropdown">
                        <button class="btn btn-sm btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            This Month
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">This Week</a></li>
                            <li><a class="dropdown-item" href="#">This Month</a></li>
                            <li><a class="dropdown-item" href="#">This Quarter</a></li>
                        </ul>
                    </div>
                </div>
                <div class="">
                    <div id="project-chart" style="min-height: 300px;"></div>
                </div>
            </div>
        </div>

        <!-- Recent Activities -->
        <div class="col-xxl-4">
            <div class="card custom-card">
                <div class="card-header justify-content-between">
                    <div class="card-title">Recent Activities</div>
                    <a href="{% url 'staff:activities' %}" class="btn btn-sm btn-primary">View All</a>
                </div>
                <div class="card-body">
                    <div class="d-flex mb-3">
                        <div class="avatar avatar-sm bg-primary-transparent rounded-circle flex-shrink-0 me-3">
                            <i class="ri-building-fill text-primary"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h6 class="mb-0">Site Inspection Completed</h6>
                            <p class="text-muted mb-0 small">Riverfront Towers • 2 hours ago</p>
                        </div>
                    </div>
                    
                    <div class="d-flex mb-3">
                        <div class="avatar avatar-sm bg-warning-transparent rounded-circle flex-shrink-0 me-3">
                            <i class="ri-calendar-event-fill text-warning"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h6 class="mb-0">Meeting with Client</h6>
                            <p class="text-muted mb-0 small">Harbor View • 4 hours ago</p>
                        </div>
                    </div>
                    
                    <div class="d-flex mb-3">
                        <div class="avatar avatar-sm bg-success-transparent rounded-circle flex-shrink-0 me-3">
                            <i class="ri-checkbox-circle-fill text-success"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h6 class="mb-0">Task Completed</h6>
                            <p class="text-muted mb-0 small">Documentation • 6 hours ago</p>
                        </div>
                    </div>
                    
                    <div class="d-flex">
                        <div class="avatar avatar-sm bg-info-transparent rounded-circle flex-shrink-0 me-3">
                            <i class="ri-time-fill text-info"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h6 class="mb-0">Time Log Updated</h6>
                            <p class="text-muted mb-0 small">Weekly Report • Yesterday</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Projects & Tasks -->
    <div class="row mt-4">
        <div class="col-xxl-6">
            <div class="card custom-card">
                <div class="card-header justify-content-between">
                    <div class="card-title">My Projects</div>
                    <a href="{% url 'staff:projects' %}" class="btn btn-sm btn-primary">View All</a>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-sm table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>Project</th>
                                    <th>Progress</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="avatar avatar-sm bg-primary-transparent rounded-circle me-2">
                                                <i class="ri-building-fill text-primary"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0">Riverfront Towers</h6>
                                                <small class="text-muted">Due: 15 Dec 2023</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="progress" style="height: 6px; width: 80px;">
                                            <div class="progress-bar bg-primary" style="width: 65%"></div>
                                        </div>
                                        <small>65%</small>
                                    </td>
                                    <td><span class="badge bg-primary-transparent">Active</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="avatar avatar-sm bg-info-transparent rounded-circle me-2">
                                                <i class="ri-home-4-fill text-info"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0">Harbor View Residences</h6>
                                                <small class="text-muted">Due: 30 Mar 2024</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="progress" style="height: 6px; width: 80px;">
                                            <div class="progress-bar bg-info" style="width: 30%"></div>
                                        </div>
                                        <small>30%</small>
                                    </td>
                                    <td><span class="badge bg-info-transparent">Planning</span></td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="avatar avatar-sm bg-warning-transparent rounded-circle me-2">
                                                <i class="ri-community-fill text-warning"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0">Westside Commercial</h6>
                                                <small class="text-muted">Due: TBD</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="progress" style="height: 6px; width: 80px;">
                                            <div class="progress-bar bg-warning" style="width: 45%"></div>
                                        </div>
                                        <small>45%</small>
                                    </td>
                                    <td><span class="badge bg-warning-transparent">On Hold</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xxl-6">
            <div class="card custom-card">
                <div class="card-header justify-content-between">
                    <div class="card-title">Upcoming Tasks</div>
                    <a href="{% url 'staff:projects' %}" class="btn btn-sm btn-primary">View All</a>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-sm table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>Task</th>
                                    <th>Project</th>
                                    <th>Due Date</th>
                                    <th>Priority</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Review Structural Drawings</td>
                                    <td>Riverfront Towers</td>
                                    <td>Today</td>
                                    <td><span class="badge bg-danger-transparent">High</span></td>
                                </tr>
                                <tr>
                                    <td>Schedule Concrete Delivery</td>
                                    <td>Harbor View</td>
                                    <td>25 Nov 2023</td>
                                    <td><span class="badge bg-warning-transparent">Medium</span></td>
                                </tr>
                                <tr>
                                    <td>Update Safety Documentation</td>
                                    <td>Westside Commercial</td>
                                    <td>05 Dec 2023</td>
                                    <td><span class="badge bg-success-transparent">Low</span></td>
                                </tr>
                                <tr>
                                    <td>Client Meeting Preparation</td>
                                    <td>Riverfront Towers</td>
                                    <td>28 Nov 2023</td>
                                    <td><span class="badge bg-warning-transparent">Medium</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Project progress chart
        var options = {
            series: [{
                name: 'Completed',
                data: [65, 30, 45, 80, 25]
            }],
            chart: {
                type: 'bar',
                height: 300,
                toolbar: {
                    show: false
                }
            },
            plotOptions: {
                bar: {
                    borderRadius: 8,
                    columnWidth: '45%',
                },
            },
            colors: ['#4B164C'],
            dataLabels: {
                enabled: false
            },
            xaxis: {
                categories: ['Riverfront Towers', 'Harbor View', 'Westside Commercial', 'Parkview Hospital', 'City Center'],
            },
            yaxis: {
                title: {
                    text: 'Progress (%)'
                },
                max: 100
            }
        };

        var chart = new ApexCharts(document.querySelector("#project-chart"), options);
        chart.render();
    });
</script>
{% endblock %}